# ‚úÖ –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Docker timeout –≤ –¥–µ–ø–ª–æ–µ

## üîç –ù–∞–π–¥–µ–Ω–Ω–∞—è –ì–õ–ê–í–ù–ê–Ø –ø—Ä–∏—á–∏–Ω–∞
**–í–µ—Ä—Å–∏—è Go –≤ go.mod**: `go 1.24.5` - —ç—Ç–∞ –≤–µ—Ä—Å–∏—è –µ—â—ë –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
Docker –æ–±—Ä–∞–∑ `golang:1.23-alpine` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ Go 1.23.12, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫—É —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

## üéØ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–ò–°–ü–†–ê–í–õ–ï–ù–´)

1. **‚ùå go.mod –≤–µ—Ä—Å–∏—è**: `go 1.24.5` ‚Üí **‚úÖ `go 1.23`**
2. **‚ùå Docker Go –≤–µ—Ä—Å–∏—è**: `golang:1.24-alpine` ‚Üí **‚úÖ `golang:1.23-alpine`**
3. **‚ùå CGO_ENABLED=1**: –∑–∞–º–µ–¥–ª—è–µ—Ç —Å–±–æ—Ä–∫—É ‚Üí **‚úÖ CGO_ENABLED=0**
4. **‚ùå –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã**: gcc, musl-dev ‚Üí **‚úÖ —É–±—Ä–∞–Ω—ã**

## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –û—Å–Ω–æ–≤–Ω–æ–π Dockerfile
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è Go: `1.23-alpine`
- ‚úÖ –£–±—Ä–∞–Ω CGO: `CGO_ENABLED=0`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏: `-ldflags="-w -s"`
- ‚úÖ –£–±—Ä–∞–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–∞–∫–µ—Ç—ã: gcc, musl-dev
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω GOPROXY –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

### 2. –£–ª—É—á—à–µ–Ω–Ω—ã–π .dockerignore
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω—ã —Ñ–∞–π–ª—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –∏ —Ç–µ—Å—Ç—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### 3. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ Dockerfile'—ã
- `Dockerfile.simple` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `Dockerfile.ci` - —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏

## –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π Dockerfile
–¢–µ–∫—É—â–∏–π `Dockerfile` —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π Dockerfile
```bash
# –í GitHub Actions –∑–∞–º–µ–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –Ω–∞:
docker build -f Dockerfile.simple -t bukhindor-api:$TAG .
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å –∫–µ—à–µ–º
```bash
# –í GitHub Actions –¥–æ–±–∞–≤—å—Ç–µ BuildKit –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
export DOCKER_BUILDKIT=1
docker build \
  --cache-from bukhindor-api:latest \
  --build-arg BUILDKIT_INLINE_CACHE=1 \
  -t bukhindor-api:$TAG .
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è GitHub Actions

### 1. –î–æ–±–∞–≤—å—Ç–µ —Ç–∞–π–º-–∞—É—Ç—ã
```yaml
- name: Build Docker image
  timeout-minutes: 10  # –î–æ–±–∞–≤—å—Ç–µ —Ç–∞–π–º-–∞—É—Ç
  run: |
    docker build -t bukhindor-api:$TAG .
```

### 2. –í–∫–ª—é—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```yaml
- name: Build Docker image
  env:
    DOCKER_BUILDKIT: 1
    BUILDKIT_PROGRESS: plain  # –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
  run: |
    docker build -t bukhindor-api:$TAG .
```

### 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
```yaml
- name: Set up Docker Buildx
  uses: docker/setup-buildx-action@v3

- name: Build and push
  uses: docker/build-push-action@v5
  with:
    context: .
    push: false
    tags: bukhindor-api:${{ env.TAG }}
    cache-from: type=gha
    cache-to: type=gha,mode=max
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–±–æ—Ä–∫—É –ª–æ–∫–∞–ª—å–Ω–æ:
time docker build -t test-build .

# –ò–ª–∏ —Å –ø—Ä–æ—Å—Ç—ã–º Dockerfile:
time docker build -f Dockerfile.simple -t test-build .
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–ª–æ–∫–∞–ª—å–Ω–æ)

- ‚ö° **Dockerfile.fast**: ~32 —Å–µ–∫—É–Ω–¥—ã  
- üöÄ **Dockerfile (–æ—Å–Ω–æ–≤–Ω–æ–π)**: ~42 —Å–µ–∫—É–Ω–¥—ã  
- üîß **Dockerfile.deploy**: ~50-60 —Å–µ–∫—É–Ω–¥  

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è GitHub Actions

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ GitHub Actions:
docker build -f Dockerfile.fast -t bukhindor-api:$TAG .
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ scripts/deploy-fast.sh –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
./scripts/deploy-fast.sh fast $TAG
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –° —Ç–∞–π–º–∞—É—Ç–æ–º –≤ Actions
```yaml
- name: Build Docker image
  timeout-minutes: 3  # 3 –º–∏–Ω—É—Ç—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
  run: |
    docker build -f Dockerfile.fast -t bukhindor-api:$TAG .
```

## üõ†Ô∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

1. **`Dockerfile.fast`** - –£–ª—å—Ç—Ä–∞-–±—ã—Å—Ç—Ä—ã–π (30-40 —Å–µ–∫)
2. **`Dockerfile.deploy`** - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (50-60 —Å–µ–∫)  
3. **`Dockerfile`** - –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π (60-80 —Å–µ–∫)

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –î–û–õ–ñ–ù–ê –±—ã—Ç—å —Ä–µ—à–µ–Ω–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è `go.mod` –∏ Dockerfile'–æ–≤, —Å–±–æ—Ä–∫–∞ –¥–æ–ª–∂–Ω–∞:
- –ó–∞–Ω–∏–º–∞—Ç—å 1-3 –º–∏–Ω—É—Ç—ã –≤–º–µ—Å—Ç–æ 15+
- –ù–µ –∑–∞–≤–∏—Å–∞—Ç—å –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –†–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ
